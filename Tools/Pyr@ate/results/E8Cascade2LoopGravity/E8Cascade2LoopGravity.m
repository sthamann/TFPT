(* ::Package:: *)

(* ::Text:: *)
(*This file was automatically generated by PyR@TE 3.*)
(*Model : E8Cascade2LoopGravity*)
(*Author : E8 Cascade v2 – 2‑Loop + Gravity Mock*)
(**)
(*Section 1 contains the renormalization group equations.*)
(*Section 2 is a proposition of a minimal working code to solve the RGEs and plot the running couplings.*)
(*Section 3 should be completed by the user since it contains the initial conditions for the running couplings.*)
(* ::Subsection:: *)
(*1. RGEs*)

(* \[Beta]-function definition *)

\[Beta][x_] := 1*Sum[If[With[{j=i}, ValueQ[\[Beta][x, j]]] && (!ValueQ[loops[x]] || i <= loops[x]),  1/(4 Pi)^(2*i)*\[Beta][x,i], 0], {i,2}]*Log[10];


(* Gauge Couplings *)

GaugeCouplings = {g1, g2, g3};

\[Beta][g1, 1] = (41/6)*g1^3;
\[Beta][g2, 1] = -11/6*g2^3;
\[Beta][g3, 1] = -7*g3^3;

\[Beta][g1, 2] = (199/18)*g1^5 + (9/2)*g1^3*g2^2 + (44/3)*g1^3*g3^2 - 5/6*g1^3*Tr[ConjugateTranspose[Yd].Yd] - 5/2*g1^3*Tr[ConjugateTranspose[Ye].Ye] - 17/6*g1^3*Tr[ConjugateTranspose[Yu].Yu] - 1/2*g1^3*Tr[ConjugateTranspose[yN].yN];
\[Beta][g2, 2] = (3/2)*g1^2*g2^3 + (163/6)*g2^5 + 12*g2^3*g3^2 - 3/2*g2^3*Tr[ConjugateTranspose[Yd].Yd] - 1/2*g2^3*Tr[ConjugateTranspose[Ye].Ye] - 3/2*g2^3*Tr[ConjugateTranspose[Yu].Yu] - 1/2*g2^3*Tr[ConjugateTranspose[yN].yN];
\[Beta][g3, 2] = (11/6)*g1^2*g3^3 + (9/2)*g2^2*g3^3 - 26*g3^5 - 2*g3^3*Tr[ConjugateTranspose[Yd].Yd] - 2*g3^3*Tr[ConjugateTranspose[Yu].Yu];


(* Yukawa Couplings *)

YukawaCouplings = {Yu, Yd, Ye, yN};

\[Beta][Yu, 1] = -17/12*g1^2*Yu - 9/4*g2^2*Yu - 8*g3^2*Yu + 3*Tr[ConjugateTranspose[Yd].Yd]*Yu + (Tr[ConjugateTranspose[Ye].Ye])*Yu + 3*Tr[ConjugateTranspose[Yu].Yu]*Yu + (Tr[ConjugateTranspose[yN].yN])*Yu - (3/2)*Yd.ConjugateTranspose[Yd].Yu + (3/2)*Yu.ConjugateTranspose[Yu].Yu;
\[Beta][Yd, 1] = -5/12*g1^2*Yd - 9/4*g2^2*Yd - 8*g3^2*Yd + 3*Tr[ConjugateTranspose[Yd].Yd]*Yd + (Tr[ConjugateTranspose[Ye].Ye])*Yd + 3*Tr[ConjugateTranspose[Yu].Yu]*Yd + (Tr[ConjugateTranspose[yN].yN])*Yd + (3/2)*Yd.ConjugateTranspose[Yd].Yd - (3/2)*Yu.ConjugateTranspose[Yu].Yd;
\[Beta][Ye, 1] = -15/4*g1^2*Ye - 9/4*g2^2*Ye + 3*Tr[ConjugateTranspose[Yd].Yd]*Ye + (Tr[ConjugateTranspose[Ye].Ye])*Ye + 3*Tr[ConjugateTranspose[Yu].Yu]*Ye + (Tr[ConjugateTranspose[yN].yN])*Ye + (3/2)*Ye.ConjugateTranspose[Ye].Ye - (3/2)*yN.ConjugateTranspose[yN].Ye;
\[Beta][yN, 1] = -3/4*g1^2*yN - 9/4*g2^2*yN + 3*Tr[ConjugateTranspose[Yd].Yd]*yN + (Tr[ConjugateTranspose[Ye].Ye])*yN + 3*Tr[ConjugateTranspose[Yu].Yu]*yN + (Tr[ConjugateTranspose[yN].yN])*yN - (3/2)*Ye.ConjugateTranspose[Ye].yN + (3/2)*yN.ConjugateTranspose[yN].yN;

\[Beta][Yu, 2] = (1187/216)*g1^4*Yu - 3/4*g1^2*g2^2*Yu + (19/9)*g1^2*g3^2*Yu + (25/24)*g1^2*Tr[ConjugateTranspose[Yd].Yd]*Yu + (25/8)*g1^2*Tr[ConjugateTranspose[Ye].Ye]*Yu + (85/24)*g1^2*Tr[ConjugateTranspose[Yu].Yu]*Yu + (5/8)*g1^2*Tr[ConjugateTranspose[yN].yN]*Yu - 43/48*g1^2*Yd.ConjugateTranspose[Yd].Yu + (223/48)*g1^2*Yu.ConjugateTranspose[Yu].Yu - 19/4*g2^4*Yu + 9*g2^2*g3^2*Yu + (45/8)*g2^2*Tr[ConjugateTranspose[Yd].Yd]*Yu + (15/8)*g2^2*Tr[ConjugateTranspose[Ye].Ye]*Yu + (45/8)*g2^2*Tr[ConjugateTranspose[Yu].Yu]*Yu + (15/8)*g2^2*Tr[ConjugateTranspose[yN].yN]*Yu + (9/16)*g2^2*Yd.ConjugateTranspose[Yd].Yu + (135/16)*g2^2*Yu.ConjugateTranspose[Yu].Yu - 108*g3^4*Yu + 20*g3^2*Tr[ConjugateTranspose[Yd].Yd]*Yu + 20*g3^2*Tr[ConjugateTranspose[Yu].Yu]*Yu - 16*g3^2*Yd.ConjugateTranspose[Yd].Yu + 16*g3^2*Yu.ConjugateTranspose[Yu].Yu + 2*lHphi^2*Yu + 6*lambda^2*Yu - 12*lambda*Yu.ConjugateTranspose[Yu].Yu + (15/4)*Tr[ConjugateTranspose[Yd].Yd]*Yd.ConjugateTranspose[Yd].Yu - 27/4*Tr[ConjugateTranspose[Yd].Yd]*Yu.ConjugateTranspose[Yu].Yu + (5/4)*Tr[ConjugateTranspose[Ye].Ye]*Yd.ConjugateTranspose[Yd].Yu - 9/4*Tr[ConjugateTranspose[Ye].Ye]*Yu.ConjugateTranspose[Yu].Yu + (15/4)*Tr[ConjugateTranspose[Yu].Yu]*Yd.ConjugateTranspose[Yd].Yu - 27/4*Tr[ConjugateTranspose[Yu].Yu]*Yu.ConjugateTranspose[Yu].Yu + (5/4)*Tr[ConjugateTranspose[yN].yN]*Yd.ConjugateTranspose[Yd].Yu - 9/4*Tr[ConjugateTranspose[yN].yN]*Yu.ConjugateTranspose[Yu].Yu - 27/4*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd]*Yu - 9/4*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye]*Yu + (1/2)*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye]*Yu + (3/2)*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu]*Yu - 27/4*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu]*Yu - 9/4*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN]*Yu + (11/4)*Yd.ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yu - 1*Yd.ConjugateTranspose[Yd].Yu.ConjugateTranspose[Yu].Yu - (1/4)*Yu.ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu + (3/2)*Yu.ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu;
\[Beta][Yd, 2] = -127/216*g1^4*Yd - 9/4*g1^2*g2^2*Yd + (31/9)*g1^2*g3^2*Yd + (25/24)*g1^2*Tr[ConjugateTranspose[Yd].Yd]*Yd + (25/8)*g1^2*Tr[ConjugateTranspose[Ye].Ye]*Yd + (85/24)*g1^2*Tr[ConjugateTranspose[Yu].Yu]*Yd + (5/8)*g1^2*Tr[ConjugateTranspose[yN].yN]*Yd + (187/48)*g1^2*Yd.ConjugateTranspose[Yd].Yd - 79/48*g1^2*Yu.ConjugateTranspose[Yu].Yd - 19/4*g2^4*Yd + 9*g2^2*g3^2*Yd + (45/8)*g2^2*Tr[ConjugateTranspose[Yd].Yd]*Yd + (15/8)*g2^2*Tr[ConjugateTranspose[Ye].Ye]*Yd + (45/8)*g2^2*Tr[ConjugateTranspose[Yu].Yu]*Yd + (15/8)*g2^2*Tr[ConjugateTranspose[yN].yN]*Yd + (135/16)*g2^2*Yd.ConjugateTranspose[Yd].Yd + (9/16)*g2^2*Yu.ConjugateTranspose[Yu].Yd - 108*g3^4*Yd + 20*g3^2*Tr[ConjugateTranspose[Yd].Yd]*Yd + 20*g3^2*Tr[ConjugateTranspose[Yu].Yu]*Yd + 16*g3^2*Yd.ConjugateTranspose[Yd].Yd - 16*g3^2*Yu.ConjugateTranspose[Yu].Yd + 2*lHphi^2*Yd + 6*lambda^2*Yd - 12*lambda*Yd.ConjugateTranspose[Yd].Yd - 27/4*Tr[ConjugateTranspose[Yd].Yd]*Yd.ConjugateTranspose[Yd].Yd + (15/4)*Tr[ConjugateTranspose[Yd].Yd]*Yu.ConjugateTranspose[Yu].Yd - 9/4*Tr[ConjugateTranspose[Ye].Ye]*Yd.ConjugateTranspose[Yd].Yd + (5/4)*Tr[ConjugateTranspose[Ye].Ye]*Yu.ConjugateTranspose[Yu].Yd - 27/4*Tr[ConjugateTranspose[Yu].Yu]*Yd.ConjugateTranspose[Yd].Yd + (15/4)*Tr[ConjugateTranspose[Yu].Yu]*Yu.ConjugateTranspose[Yu].Yd - 9/4*Tr[ConjugateTranspose[yN].yN]*Yd.ConjugateTranspose[Yd].Yd + (5/4)*Tr[ConjugateTranspose[yN].yN]*Yu.ConjugateTranspose[Yu].Yd - 27/4*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd]*Yd - 9/4*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye]*Yd + (1/2)*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye]*Yd + (3/2)*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu]*Yd - 27/4*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu]*Yd - 9/4*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN]*Yd + (3/2)*Yd.ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd - (1/4)*Yd.ConjugateTranspose[Yd].Yu.ConjugateTranspose[Yu].Yd - 1*Yu.ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yd + (11/4)*Yu.ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yd;
\[Beta][Ye, 2] = (457/24)*g1^4*Ye + (9/4)*g1^2*g2^2*Ye + (25/24)*g1^2*Tr[ConjugateTranspose[Yd].Yd]*Ye + (25/8)*g1^2*Tr[ConjugateTranspose[Ye].Ye]*Ye + (85/24)*g1^2*Tr[ConjugateTranspose[Yu].Yu]*Ye + (5/8)*g1^2*Tr[ConjugateTranspose[yN].yN]*Ye + (129/16)*g1^2*Ye.ConjugateTranspose[Ye].Ye - 45/16*g1^2*yN.ConjugateTranspose[yN].Ye - 19/4*g2^4*Ye + (45/8)*g2^2*Tr[ConjugateTranspose[Yd].Yd]*Ye + (15/8)*g2^2*Tr[ConjugateTranspose[Ye].Ye]*Ye + (45/8)*g2^2*Tr[ConjugateTranspose[Yu].Yu]*Ye + (15/8)*g2^2*Tr[ConjugateTranspose[yN].yN]*Ye + (135/16)*g2^2*Ye.ConjugateTranspose[Ye].Ye + (9/16)*g2^2*yN.ConjugateTranspose[yN].Ye + 20*g3^2*Tr[ConjugateTranspose[Yd].Yd]*Ye + 20*g3^2*Tr[ConjugateTranspose[Yu].Yu]*Ye + 2*lHphi^2*Ye + 6*lambda^2*Ye - 12*lambda*Ye.ConjugateTranspose[Ye].Ye - 27/4*Tr[ConjugateTranspose[Yd].Yd]*Ye.ConjugateTranspose[Ye].Ye + (15/4)*Tr[ConjugateTranspose[Yd].Yd]*yN.ConjugateTranspose[yN].Ye - 9/4*Tr[ConjugateTranspose[Ye].Ye]*Ye.ConjugateTranspose[Ye].Ye + (5/4)*Tr[ConjugateTranspose[Ye].Ye]*yN.ConjugateTranspose[yN].Ye - 27/4*Tr[ConjugateTranspose[Yu].Yu]*Ye.ConjugateTranspose[Ye].Ye + (15/4)*Tr[ConjugateTranspose[Yu].Yu]*yN.ConjugateTranspose[yN].Ye - 9/4*Tr[ConjugateTranspose[yN].yN]*Ye.ConjugateTranspose[Ye].Ye + (5/4)*Tr[ConjugateTranspose[yN].yN]*yN.ConjugateTranspose[yN].Ye - 27/4*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd]*Ye - 9/4*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye]*Ye + (1/2)*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye]*Ye + (3/2)*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu]*Ye - 27/4*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu]*Ye - 9/4*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN]*Ye + (3/2)*Ye.ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye - (1/4)*Ye.ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye - 1*yN.ConjugateTranspose[yN].Ye.ConjugateTranspose[Ye].Ye + (11/4)*yN.ConjugateTranspose[yN].yN.ConjugateTranspose[yN].Ye;
\[Beta][yN, 2] = (35/24)*g1^4*yN - 9/4*g1^2*g2^2*yN + (25/24)*g1^2*Tr[ConjugateTranspose[Yd].Yd]*yN + (25/8)*g1^2*Tr[ConjugateTranspose[Ye].Ye]*yN + (85/24)*g1^2*Tr[ConjugateTranspose[Yu].Yu]*yN + (5/8)*g1^2*Tr[ConjugateTranspose[yN].yN]*yN - 81/16*g1^2*Ye.ConjugateTranspose[Ye].yN + (93/16)*g1^2*yN.ConjugateTranspose[yN].yN - 19/4*g2^4*yN + (45/8)*g2^2*Tr[ConjugateTranspose[Yd].Yd]*yN + (15/8)*g2^2*Tr[ConjugateTranspose[Ye].Ye]*yN + (45/8)*g2^2*Tr[ConjugateTranspose[Yu].Yu]*yN + (15/8)*g2^2*Tr[ConjugateTranspose[yN].yN]*yN + (9/16)*g2^2*Ye.ConjugateTranspose[Ye].yN + (135/16)*g2^2*yN.ConjugateTranspose[yN].yN + 20*g3^2*Tr[ConjugateTranspose[Yd].Yd]*yN + 20*g3^2*Tr[ConjugateTranspose[Yu].Yu]*yN + 2*lHphi^2*yN + 6*lambda^2*yN - 12*lambda*yN.ConjugateTranspose[yN].yN + (15/4)*Tr[ConjugateTranspose[Yd].Yd]*Ye.ConjugateTranspose[Ye].yN - 27/4*Tr[ConjugateTranspose[Yd].Yd]*yN.ConjugateTranspose[yN].yN + (5/4)*Tr[ConjugateTranspose[Ye].Ye]*Ye.ConjugateTranspose[Ye].yN - 9/4*Tr[ConjugateTranspose[Ye].Ye]*yN.ConjugateTranspose[yN].yN + (15/4)*Tr[ConjugateTranspose[Yu].Yu]*Ye.ConjugateTranspose[Ye].yN - 27/4*Tr[ConjugateTranspose[Yu].Yu]*yN.ConjugateTranspose[yN].yN + (5/4)*Tr[ConjugateTranspose[yN].yN]*Ye.ConjugateTranspose[Ye].yN - 9/4*Tr[ConjugateTranspose[yN].yN]*yN.ConjugateTranspose[yN].yN - 27/4*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd]*yN - 9/4*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye]*yN + (1/2)*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye]*yN + (3/2)*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu]*yN - 27/4*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu]*yN - 9/4*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN]*yN + (11/4)*Ye.ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].yN - 1*Ye.ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].yN - (1/4)*yN.ConjugateTranspose[yN].Ye.ConjugateTranspose[Ye].yN + (3/2)*yN.ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN;


(* Quartic Couplings *)

QuarticCouplings = {lambda, lPhi, lHphi};

\[Beta][lambda, 1] = (3/8)*g1^4 + (3/4)*g1^2*g2^2 - 3*g1^2*lambda + (9/8)*g2^4 - 9*g2^2*lambda + 4*lHphi^2 + 24*lambda^2 + 12*lambda*Tr[ConjugateTranspose[Yd].Yd] + 4*lambda*Tr[ConjugateTranspose[Ye].Ye] + 12*lambda*Tr[ConjugateTranspose[Yu].Yu] + 4*lambda*Tr[ConjugateTranspose[yN].yN] - 6*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 2*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 6*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - 2*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];
\[Beta][lPhi, 1] = 2*lHphi^2 + 80*lPhi^2;
\[Beta][lHphi, 1] = -3/2*g1^2*lHphi - 9/2*g2^2*lHphi + 8*lHphi^2 + 32*lHphi*lPhi + 12*lHphi*lambda + 6*lHphi*Tr[ConjugateTranspose[Yd].Yd] + 2*lHphi*Tr[ConjugateTranspose[Ye].Ye] + 6*lHphi*Tr[ConjugateTranspose[Yu].Yu] + 2*lHphi*Tr[ConjugateTranspose[yN].yN];

\[Beta][lambda, 2] = -379/48*g1^6 - 559/48*g1^4*g2^2 + (629/24)*g1^4*lambda + (5/4)*g1^4*Tr[ConjugateTranspose[Yd].Yd] - 25/4*g1^4*Tr[ConjugateTranspose[Ye].Ye] - 19/4*g1^4*Tr[ConjugateTranspose[Yu].Yu] - 1/4*g1^4*Tr[ConjugateTranspose[yN].yN] - 353/48*g1^2*g2^4 + (39/4)*g1^2*g2^2*lambda + (9/2)*g1^2*g2^2*Tr[ConjugateTranspose[Yd].Yd] + (11/2)*g1^2*g2^2*Tr[ConjugateTranspose[Ye].Ye] + (21/2)*g1^2*g2^2*Tr[ConjugateTranspose[Yu].Yu] - 1/2*g1^2*g2^2*Tr[ConjugateTranspose[yN].yN] + 36*g1^2*lambda^2 + (25/6)*g1^2*lambda*Tr[ConjugateTranspose[Yd].Yd] + (25/2)*g1^2*lambda*Tr[ConjugateTranspose[Ye].Ye] + (85/6)*g1^2*lambda*Tr[ConjugateTranspose[Yu].Yu] + (5/2)*g1^2*lambda*Tr[ConjugateTranspose[yN].yN] + (4/3)*g1^2*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 4*g1^2*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 8/3*g1^2*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] + (241/16)*g2^6 + (7/8)*g2^4*lambda - 9/4*g2^4*Tr[ConjugateTranspose[Yd].Yd] - 3/4*g2^4*Tr[ConjugateTranspose[Ye].Ye] - 9/4*g2^4*Tr[ConjugateTranspose[Yu].Yu] - 3/4*g2^4*Tr[ConjugateTranspose[yN].yN] + 108*g2^2*lambda^2 + (45/2)*g2^2*lambda*Tr[ConjugateTranspose[Yd].Yd] + (15/2)*g2^2*lambda*Tr[ConjugateTranspose[Ye].Ye] + (45/2)*g2^2*lambda*Tr[ConjugateTranspose[Yu].Yu] + (15/2)*g2^2*lambda*Tr[ConjugateTranspose[yN].yN] + 80*g3^2*lambda*Tr[ConjugateTranspose[Yd].Yd] + 80*g3^2*lambda*Tr[ConjugateTranspose[Yu].Yu] - 32*g3^2*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 32*g3^2*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - 32*lHphi^3 - 40*lHphi^2*lambda - 312*lambda^3 - 144*lambda^2*Tr[ConjugateTranspose[Yd].Yd] - 48*lambda^2*Tr[ConjugateTranspose[Ye].Ye] - 144*lambda^2*Tr[ConjugateTranspose[Yu].Yu] - 48*lambda^2*Tr[ConjugateTranspose[yN].yN] - 3*lambda*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - lambda*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 14*lambda*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 42*lambda*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] - 3*lambda*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - lambda*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN] + 30*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] + 10*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 2*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 2*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].yN.ConjugateTranspose[yN].Ye] - 6*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yu] - 6*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] + 30*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] + 10*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];
\[Beta][lPhi, 2] = 4*g1^2*lHphi^2 + 12*g2^2*lHphi^2 - 16*lHphi^3 - 80*lHphi^2*lPhi - 12*lHphi^2*Tr[ConjugateTranspose[Yd].Yd] - 4*lHphi^2*Tr[ConjugateTranspose[Ye].Ye] - 12*lHphi^2*Tr[ConjugateTranspose[Yu].Yu] - 4*lHphi^2*Tr[ConjugateTranspose[yN].yN] - 3840*lPhi^3;
\[Beta][lHphi, 2] = (557/48)*g1^4*lHphi + (15/8)*g1^2*g2^2*lHphi + 2*g1^2*lHphi^2 + 24*g1^2*lHphi*lambda + (25/12)*g1^2*lHphi*Tr[ConjugateTranspose[Yd].Yd] + (25/4)*g1^2*lHphi*Tr[ConjugateTranspose[Ye].Ye] + (85/12)*g1^2*lHphi*Tr[ConjugateTranspose[Yu].Yu] + (5/4)*g1^2*lHphi*Tr[ConjugateTranspose[yN].yN] - 65/16*g2^4*lHphi + 6*g2^2*lHphi^2 + 72*g2^2*lHphi*lambda + (45/4)*g2^2*lHphi*Tr[ConjugateTranspose[Yd].Yd] + (15/4)*g2^2*lHphi*Tr[ConjugateTranspose[Ye].Ye] + (45/4)*g2^2*lHphi*Tr[ConjugateTranspose[Yu].Yu] + (15/4)*g2^2*lHphi*Tr[ConjugateTranspose[yN].yN] + 40*g3^2*lHphi*Tr[ConjugateTranspose[Yd].Yd] + 40*g3^2*lHphi*Tr[ConjugateTranspose[Yu].Yu] - 44*lHphi^3 - 384*lHphi^2*lPhi - 144*lHphi^2*lambda - 24*lHphi^2*Tr[ConjugateTranspose[Yd].Yd] - 8*lHphi^2*Tr[ConjugateTranspose[Ye].Ye] - 24*lHphi^2*Tr[ConjugateTranspose[Yu].Yu] - 8*lHphi^2*Tr[ConjugateTranspose[yN].yN] - 640*lHphi*lPhi^2 - 60*lHphi*lambda^2 - 72*lHphi*lambda*Tr[ConjugateTranspose[Yd].Yd] - 24*lHphi*lambda*Tr[ConjugateTranspose[Ye].Ye] - 72*lHphi*lambda*Tr[ConjugateTranspose[Yu].Yu] - 24*lHphi*lambda*Tr[ConjugateTranspose[yN].yN] - 27/2*lHphi*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 9/2*lHphi*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 7*lHphi*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 21*lHphi*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] - 27/2*lHphi*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - 9/2*lHphi*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];


(* Trilinear Couplings *)

TrilinearCouplings = {cR3};

\[Beta][cR3, 1] = -3/2*cR3*g1^2 - 9/2*cR3*g2^2 + 12*cR3*lambda + 6*cR3*Tr[ConjugateTranspose[Yd].Yd] + 2*cR3*Tr[ConjugateTranspose[Ye].Ye] + 6*cR3*Tr[ConjugateTranspose[Yu].Yu] + 2*cR3*Tr[ConjugateTranspose[yN].yN];

\[Beta][cR3, 2] = (557/48)*cR3*g1^4 + (15/8)*cR3*g1^2*g2^2 + 24*cR3*g1^2*lambda + (25/12)*cR3*g1^2*Tr[ConjugateTranspose[Yd].Yd] + (25/4)*cR3*g1^2*Tr[ConjugateTranspose[Ye].Ye] + (85/12)*cR3*g1^2*Tr[ConjugateTranspose[Yu].Yu] + (5/4)*cR3*g1^2*Tr[ConjugateTranspose[yN].yN] - 65/16*cR3*g2^4 + 72*cR3*g2^2*lambda + (45/4)*cR3*g2^2*Tr[ConjugateTranspose[Yd].Yd] + (15/4)*cR3*g2^2*Tr[ConjugateTranspose[Ye].Ye] + (45/4)*cR3*g2^2*Tr[ConjugateTranspose[Yu].Yu] + (15/4)*cR3*g2^2*Tr[ConjugateTranspose[yN].yN] + 40*cR3*g3^2*Tr[ConjugateTranspose[Yd].Yd] + 40*cR3*g3^2*Tr[ConjugateTranspose[Yu].Yu] - 4*cR3*lHphi^2 - 60*cR3*lambda^2 - 72*cR3*lambda*Tr[ConjugateTranspose[Yd].Yd] - 24*cR3*lambda*Tr[ConjugateTranspose[Ye].Ye] - 72*cR3*lambda*Tr[ConjugateTranspose[Yu].Yu] - 24*cR3*lambda*Tr[ConjugateTranspose[yN].yN] - 27/2*cR3*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 9/2*cR3*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 7*cR3*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 21*cR3*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] - 27/2*cR3*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - 9/2*cR3*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];


(* Scalar Mass Couplings *)

ScalarMassCouplings = {mu2, MPhi};

\[Beta][mu2, 1] = -8*MPhi*lHphi - 2*cR3^2 - 3/2*g1^2*mu2 - 9/2*g2^2*mu2 + 12*lambda*mu2 + 6*mu2*Tr[ConjugateTranspose[Yd].Yd] + 2*mu2*Tr[ConjugateTranspose[Ye].Ye] + 6*mu2*Tr[ConjugateTranspose[Yu].Yu] + 2*mu2*Tr[ConjugateTranspose[yN].yN];
\[Beta][MPhi, 1] = 32*MPhi*lPhi - 4*lHphi*mu2;

\[Beta][mu2, 2] = 32*MPhi*lHphi^2 - 1/2*cR3^2*g1^2 - 3/2*cR3^2*g2^2 + 36*cR3^2*lambda + 6*cR3^2*Tr[ConjugateTranspose[Yd].Yd] + 2*cR3^2*Tr[ConjugateTranspose[Ye].Ye] + 6*cR3^2*Tr[ConjugateTranspose[Yu].Yu] + 2*cR3^2*Tr[ConjugateTranspose[yN].yN] + (557/48)*g1^4*mu2 + (15/8)*g1^2*g2^2*mu2 + 24*g1^2*lambda*mu2 + (25/12)*g1^2*mu2*Tr[ConjugateTranspose[Yd].Yd] + (25/4)*g1^2*mu2*Tr[ConjugateTranspose[Ye].Ye] + (85/12)*g1^2*mu2*Tr[ConjugateTranspose[Yu].Yu] + (5/4)*g1^2*mu2*Tr[ConjugateTranspose[yN].yN] - 65/16*g2^4*mu2 + 72*g2^2*lambda*mu2 + (45/4)*g2^2*mu2*Tr[ConjugateTranspose[Yd].Yd] + (15/4)*g2^2*mu2*Tr[ConjugateTranspose[Ye].Ye] + (45/4)*g2^2*mu2*Tr[ConjugateTranspose[Yu].Yu] + (15/4)*g2^2*mu2*Tr[ConjugateTranspose[yN].yN] + 40*g3^2*mu2*Tr[ConjugateTranspose[Yd].Yd] + 40*g3^2*mu2*Tr[ConjugateTranspose[Yu].Yu] - 4*lHphi^2*mu2 - 60*lambda^2*mu2 - 72*lambda*mu2*Tr[ConjugateTranspose[Yd].Yd] - 24*lambda*mu2*Tr[ConjugateTranspose[Ye].Ye] - 72*lambda*mu2*Tr[ConjugateTranspose[Yu].Yu] - 24*lambda*mu2*Tr[ConjugateTranspose[yN].yN] - 27/2*mu2*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] - 9/2*mu2*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 7*mu2*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 21*mu2*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] - 27/2*mu2*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] - 9/2*mu2*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];
\[Beta][MPhi, 2] = -8*MPhi*lHphi^2 - 640*MPhi*lPhi^2 - 4*cR3^2*lHphi - 8*g1^2*lHphi*mu2 - 24*g2^2*lHphi*mu2 + 16*lHphi^2*mu2 + 24*lHphi*mu2*Tr[ConjugateTranspose[Yd].Yd] + 8*lHphi*mu2*Tr[ConjugateTranspose[Ye].Ye] + 24*lHphi*mu2*Tr[ConjugateTranspose[Yu].Yu] + 8*lHphi*mu2*Tr[ConjugateTranspose[yN].yN];


(* Vacuum-expectation Values *)

Vevs = {vSM, vPQ};

(* For vevs the gauge must be fixed. Let's use for instance the Landau gauge : *)
xiGauge = 0;

\[Beta][vSM, 1] = (1/4)*xiGauge*g1^2*vSM + (3/4)*xiGauge*g2^2*vSM + (3/4)*g1^2*vSM + (9/4)*g2^2*vSM - 3*vSM*Tr[ConjugateTranspose[Yd].Yd] - vSM*Tr[ConjugateTranspose[Ye].Ye] - 3*vSM*Tr[ConjugateTranspose[Yu].Yu] - vSM*Tr[ConjugateTranspose[yN].yN];
\[Beta][vPQ, 1] = 0;

\[Beta][vSM, 2] = (1/8)*xiGauge^2*g1^4*vSM + (3/4)*xiGauge^2*g1^2*g2^2*vSM + (1/8)*xiGauge*g1^4*vSM + (3/4)*xiGauge*g1^2*g2^2*vSM - 3/2*xiGauge*g1^2*vSM*Tr[ConjugateTranspose[Yd].Yd] - 1/2*xiGauge*g1^2*vSM*Tr[ConjugateTranspose[Ye].Ye] - 3/2*xiGauge*g1^2*vSM*Tr[ConjugateTranspose[Yu].Yu] - 1/2*xiGauge*g1^2*vSM*Tr[ConjugateTranspose[yN].yN] + (27/8)*xiGauge*g2^4*vSM - 9/2*xiGauge*g2^2*vSM*Tr[ConjugateTranspose[Yd].Yd] - 3/2*xiGauge*g2^2*vSM*Tr[ConjugateTranspose[Ye].Ye] - 9/2*xiGauge*g2^2*vSM*Tr[ConjugateTranspose[Yu].Yu] - 3/2*xiGauge*g2^2*vSM*Tr[ConjugateTranspose[yN].yN] - 431/96*g1^4*vSM - 9/16*g1^2*g2^2*vSM - 25/24*g1^2*vSM*Tr[ConjugateTranspose[Yd].Yd] - 25/8*g1^2*vSM*Tr[ConjugateTranspose[Ye].Ye] - 85/24*g1^2*vSM*Tr[ConjugateTranspose[Yu].Yu] - 5/8*g1^2*vSM*Tr[ConjugateTranspose[yN].yN] + (191/32)*g2^4*vSM - 45/8*g2^2*vSM*Tr[ConjugateTranspose[Yd].Yd] - 15/8*g2^2*vSM*Tr[ConjugateTranspose[Ye].Ye] - 45/8*g2^2*vSM*Tr[ConjugateTranspose[Yu].Yu] - 15/8*g2^2*vSM*Tr[ConjugateTranspose[yN].yN] - 20*g3^2*vSM*Tr[ConjugateTranspose[Yd].Yd] - 20*g3^2*vSM*Tr[ConjugateTranspose[Yu].Yu] - 2*lHphi^2*vSM - 6*lambda^2*vSM + (27/4)*vSM*Tr[ConjugateTranspose[Yd].Yd.ConjugateTranspose[Yd].Yd] + (9/4)*vSM*Tr[ConjugateTranspose[Ye].Ye.ConjugateTranspose[Ye].Ye] - 1/2*vSM*Tr[ConjugateTranspose[Ye].yN.ConjugateTranspose[yN].Ye] - 3/2*vSM*Tr[ConjugateTranspose[Yu].Yd.ConjugateTranspose[Yd].Yu] + (27/4)*vSM*Tr[ConjugateTranspose[Yu].Yu.ConjugateTranspose[Yu].Yu] + (9/4)*vSM*Tr[ConjugateTranspose[yN].yN.ConjugateTranspose[yN].yN];
\[Beta][vPQ, 2] = -4*lHphi^2*vPQ - 64*lPhi^2*vPQ;
(* ::Subsection:: *)
(*2. Solving and plotting functions*)

(* ::Subsubsection::Closed:: *)
(*RG-solving functions*)

(* Solving function *)

RGsolve[initialScale_, range_] := Block[{allCouplings, couplingsToFunction, differentialEquations, initialConditions, allEquations, solutions, yukawaLike},
	(* Define and solve the system of coupled differential equations *)
	allCouplings = Join[GaugeCouplings, YukawaCouplings, QuarticCouplings, TrilinearCouplings, ScalarMassCouplings, Vevs];
	couplingsToFunction = # -> #[t] & /@ allCouplings;

	differentialEquations = (#'[t] == (\[Beta][#] /. couplingsToFunction) & /@ allCouplings);
	initialConditions = (#[initialScale] == init[#] & /@ allCouplings);
	allEquations = Join[differentialEquations, initialConditions];

	solutions = NDSolve[allEquations, allCouplings /. couplingsToFunction, {t, range[[1]], range[[2]]}][[1]];

	(* Now split matrix couplings into their individual components *)
	yukawaLike = {{Yu, {3, 3}}, {Yd, {3, 3}}, {Ye, {3, 3}}, {yN, {3, 3}}};
	solutions = Block[{coupling, function, shape},
					coupling = #[[1,0]];
					function = #[[2]];
					If[MemberQ[Flatten@yukawaLike, coupling],
						shape = yukawaLike[[Position[yukawaLike, coupling][[1,1]], 2]];
						Sequence @@ Flatten @ Table[coupling[i,j] -> FunctionInterpolation[If[NumericQ[t], function[[i,j]]], {t, range[[1]], range[[2]]}][t], {i, shape[[1]]}, {j, shape[[2]]}],
						coupling -> function]]& /@ solutions;

	Return[solutions];
];

(* The following function removes from the list the couplings which seem to identically vanish over the energy range *)
DiscardZeroCouplings[range_, solutions_] := Block[{N, testPoints},
	N = 20;
	testPoints =  Range[range[[1]], range[[2]], (range[[2]] - range[[1]])/N];
	Return @ Select[solutions, (DeleteDuplicates[#[[2, 0]] /@ testPoints] != {0}) &];
];
(* ::Subsubsection::Closed:: *)
(*Plot function*)

(* Plotting function handling both real and complex quantities *)

Complexplot[funcs_, {min_, max_}, legends_, plotRange_] := Block[{cplxPos, newFuncs, newLegends},
	cplxPos = If[Head[Chop[funcs[[#]] /. t -> 1/2(max-min)]] === Complex,#, Nothing]& /@ Range[Length[funcs]];
	newFuncs = If[MemberQ[cplxPos, #], Sequence @@ {Re@funcs[[#]], Im@funcs[[#]]}, funcs[[#]]]& /@ Range[Length[funcs]];
	newLegends = If[MemberQ[cplxPos, #], Sequence @@ {Re@legends[[#]], Im@legends[[#]]}, legends[[#]]]& /@ Range[Length[funcs]];

	Return @ Plot[Evaluate @ newFuncs, {t, min, max}, PlotLegends->newLegends, PlotRange->plotRange]
 ]


RGplot[range_, solutions_] := Block[{selectType, toPlot},
	selectType[type_] := Select[solutions, MemberQ[type, If[Head@#[[1]] =!= Symbol, Head@#[[1]], #[[1]]]]&];

	toPlot = selectType[GaugeCouplings];
	If[toPlot =!= {},
		Print["### Gauge Couplings ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];

	toPlot = selectType[YukawaCouplings];
	If[toPlot =!= {},
		Print["### Yukawa Couplings ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];

	toPlot = selectType[QuarticCouplings];
	If[toPlot =!= {},
		Print["### Quartic Couplings ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];

	toPlot = selectType[TrilinearCouplings];
	If[toPlot =!= {},
		Print["### Trilinear Couplings ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];

	toPlot = selectType[ScalarMassCouplings];
	If[toPlot =!= {},
		Print["### Scalar Mass Couplings ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];

	toPlot = selectType[Vevs];
	If[toPlot =!= {},
		Print["### Vacuum-expectation Values ###"];
		Print @ Complexplot[toPlot[[All, 2]], range, toPlot[[All, 1]], All];
	];
];
(* ::Subsection:: *)
(*3. Actual solving*)


(* Some useful quantities. Energy and mass are in units of Log10[ GeV ] *)

MZ = 91.1876                 // Log10; (* Z boson mass *)
MP = 1.22*10^19              // Log10; (* Planck mass *)
Mp = 1.22*10^19 / Sqrt[8 Pi] // Log10; (* Reduced Planck mass *)

MT = 173.0 // Log10; (* Pole top mass *)

vev = 246.22 // Log10; (* SM Higgs vacuum-expectation value *)


(*** Initial conditions ; Energy range ***)

initialScale = MZ;
range = {0, MP};

(* Gauge Couplings *)

init[g1] = 0;
init[g2] = 0;
init[g3] = 0;

(* Yukawa Couplings *)

init[Yu] = {{0, 0, 0},
            {0, 0, 0},
            {0, 0, 0}};

init[Yd] = {{0, 0, 0},
            {0, 0, 0},
            {0, 0, 0}};

init[Ye] = {{0, 0, 0},
            {0, 0, 0},
            {0, 0, 0}};

init[yN] = {{0, 0, 0},
            {0, 0, 0},
            {0, 0, 0}};

(* Quartic Couplings *)

init[lambda] = 0;
init[lPhi] = 0;
init[lHphi] = 0;

(* Trilinear Couplings *)

init[cR3] = 0;

(* Scalar Mass Couplings *)

init[mu2] = 0;
init[MPhi] = 0;

(* Vacuum-expectation Values *)

init[vSM] = 0;
init[vPQ] = 0;


(* Definition of the running scheme *)

(loops[#] = 2)& /@ GaugeCouplings;
(loops[#] = 2)& /@ YukawaCouplings;
(loops[#] = 2)& /@ QuarticCouplings;
(loops[#] = 2)& /@ TrilinearCouplings;
(loops[#] = 2)& /@ ScalarMassCouplings;
(loops[#] = 2)& /@ Vevs;


(* Now call the functions defined in section 2 *)

solutions = RGsolve[initialScale, range];
solutions = DiscardZeroCouplings[range, solutions];

RGplot[range, solutions]